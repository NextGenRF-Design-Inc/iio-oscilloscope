
![logo](https://www.nextgenrf.com/assets/uploads/2020/06/logo.jpg)

# NextGen RF Design HDL

Included in this repository is the HDL design files for NextGen RF Design platforms.  The goal of this repository is to enable 
users to quickly generate and build the HDL based on the source files.  To that end all projects and IP can be generated by 
running a single script.  Both Windows and Linux operating systems are supported and can be used to build the source.

## Folder Structure

The source files are organized in the following folders.  

* **boards:** Board definition files define hardware specific functionality.
* **docs:** High level documents not specific to a design.
* **ip:** Common HDL modules used across multiple projects.
* **projects:** Set of functionality to be built on a specific hardware platform. 


### Project Folder

The projects folder contains source code that is organized to provide a specific set of functionality.  For example project x might be a IP router whereas project y may be a wireless gateway.  Each project has the ability to support multiple hardware platforms.  This allows a project with a specific set of functionality to be built on the desired hardware platform.  Within the project folder is a folder for each hardware platform.  A "common" folder is included within the project folder when there are common source files shared across the hardware platforms.  Each hardware folder contains a Makefile script for building the project for the corresponding hardware.  Along with the Makefile each hardware folder within the project may include hardware specific source code.  Below is the high level folder structure of the projects folder.

```
projects
│
└── project_x
│   └── common
│   │   └── ...
│   └── hardware_a
│   │   └── Makefile
│   │   └── ...
│   └── hardware_b
│       └── Makefile
│       └── ...
└── project_y
│   └── common
│   │   └── ...
│   └── hardware_b
│   │   └── Makefile
│   │   └── ...
└── project_z
│   └── common
│   │   └── ...
│   └── hardware_b
│   │   └── Makefile
│   │   └── ...
│   └── hardware_c
│       └── Makefile
│       └── ...
└── ...
```


### IP Folder
The ip folder contains source files used across several projects.  Each ip is organized based on functionality.  In general the ip modules are independent of the hardware platform with the exception of hardware peripherals such as an ADC, RFIC, etc.  When building a project the ip source files are imported and built alongside the project.  


## Build Environment

To build the HDL source the build environment including a PC and appropriate software must be setup. The host PC should have a minimum of 8 processor cores, 16GB DDR4 RAM, and ~64GB of hard drive space.  A solid state hard drive will perform noticeably faster due to the large size of software tools and project environments.  

The HDL can be built using Windows or Linux operating systems installed on the host PC.  For additional information see [Linux Host Build Environment](/docs/pc_setup_linux.md) or [Windows Host Build Environment](/docs/pc_setup_windows.md).


## Building Source

To build the source files a project and development environment must be created and setup.  This is done using a Makefile script.  The script executes all steps from creating a project, building appropriate ip, and generating the final output products.  To accomplish this simply issue the "make" command from a bash terminal with the corresponding project path specified.  For example the following builds the source for "project_x".  In this case the project files and output products will be generated in the working folder.  

```
  make -f <directory of hdl folder>\hdl\projects\project_x
```  

It is best to generate the project files and output products outside of the hdl repository.  This keeps the repository directory clean since none of the project files or output products should ever be checked into the repo.  It is best to create a workspace folder and execute the make command from the workspace.  For example the following clones the hdl repository at the C: drive.  A workspace folder is then created and "project_x" is built.  The project files and output products will be placed in a folder labeled "vivado" within the workspace folder.  

 
```
  cd ~/
  git clone http://ngrf.poweredbyclear.com:3000/NGRF/HDL.git  
  mkdir -p ~/workspace
  cd ~/workspace
  make -f ~/hdl/projects/project_x/hardware_a/Makefile
```  

Once the output products are no longer needed the entire workspace folder can be deleted.  Modification of source files should only be made to the files in the "/hdl/projects/project_x/common" folder.  If the project includes a block design and it has been modified you can "Export Block Design" to the "/hdl/projects/project_x/common" folder.  If new source files are added to the project they must be stored in the "/hdl/projects/project_x/common" folder and not added directly to the project workspace.  

For Linux host machines the Makefile should be called from the bash terminal.  For Windows host machines the Makefile should be called using Cygwin.  See [Windows Host Build Environment](pc_setup_windows.md) for more information regarding Cygwin.  The Makefile simply instantiates the appropriate development tools and calls a tcl script.  

## Creating IP

The ip designs are built the same way as a project with two major exceptions.  First once the environment has been built using the "make" script it automatically deletes the "Vivado" folder.  Second, the make script generates a set of IP definition files for projects to reference.  When building a project any referenced IP designs are automatically created ensuring the IP definitions are up to date.


## Simulation
If the project or ip includes a test bench there should be a corresponding Makefile file that creates the project.


## Disclaimer

NextGen RF Design makes no warranty for the use of this code or design. This code is provided  "As Is". NextGen RF Design assumes no responsibility for
any errors, which may appear in this code, nor does it make a commitment to update the information contained herein. NextGen RF Design specifically
disclaims any implied warranties of fitness for a particular purpose.
Copyright(c) NextGen RF Design
All rights reserved.

